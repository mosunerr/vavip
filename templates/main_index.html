{% extends "layout.html" %}
{% block title %}Главная страница Vavip{% endblock %}

{% block video_fullscreen %}
<style>
/* Видео секции */
.video-section {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  scroll-snap-align: start;
}

.video-section video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.video-section + .video-section { margin-top: -5vh; }

/* Надписи на видео */
.video-caption {
  position: absolute;
  bottom: 80px;
  width: 100%;
  text-align: center;
  font-family: Helvetica, Arial, sans-serif;
  font-weight: 200;
  font-size: 1.2rem;
  color: #fff;
  text-shadow: 0 1px 6px rgba(0,0,0,0.5);
  pointer-events: none;
  opacity: 0.7;
  transition: transform 0.3s, opacity 0.3s;
}

.video-section.active .video-caption {
  transform: translateY(-10px);
  opacity: 1;
}

/* Scroll snap */
html, body {
  height: 100%;
  margin: 0;
  scroll-behavior: smooth;
  scroll-snap-type: y mandatory;
  overflow-y: scroll;
}

/* Футер поверх 4-го видео */
.video-footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  left: 0;
  background-color: rgba(18, 20, 22, 0.95);
  z-index: 10;
}
</style>

<div class="video-section">
  <video autoplay muted loop playsinline preload="auto" poster="{{ url_for('static', filename='images/video-poster.jpg') }}">
    <source src="{{ url_for('static', filename='videos/background1.mp4') }}" type="video/mp4">
  </video>
  <div class="video-caption">Узел ввода</div>
</div>

<div class="video-section">
  <video autoplay muted loop playsinline preload="auto" poster="{{ url_for('static', filename='images/video-poster2.jpg') }}">
    <source src="{{ url_for('static', filename='videos/background2.mp4') }}" type="video/mp4">
  </video>
  <div class="video-caption">Проектирование BIM</div>
</div>

<div class="video-section">
  <video autoplay muted loop playsinline preload="auto" poster="{{ url_for('static', filename='images/video-poster3.jpg') }}">
    <source src="{{ url_for('static', filename='videos/background3.mp4') }}" type="video/mp4">
  </video>
  <div class="video-caption">Бутик</div>
</div>

<div class="video-section">
  <video autoplay muted loop playsinline preload="auto" poster="{{ url_for('static', filename='images/video-poster4.jpg') }}">
    <source src="{{ url_for('static', filename='videos/background4.mp4') }}" type="video/mp4">
  </video>
  <div class="video-caption">Магазин</div>

  <!-- Футер поверх 4-го видео -->
  <footer class="video-footer">
    <div class="footer-content">
      <div class="columns">
        <div>
          <strong>КОНФИДЕЦИАЛЬНОСТЬ И УСЛОВИЯ</strong>
          <a href="#">ПОЛИТИКА ОБРАБОТКИ И ЗАЩИТЫ ПЕРСОНАЛЬНЫХ ДАННЫХ И ИСПОЛЬЗОВАНИЯ COOKIE</a>
          <a href="#">ДОГОВОР ОФЕРТЫ БИМ</a>
          <a href="#">ГАРАНТИЯ</a>
          <a href="#">ДОГОВОР НА ПРОЕКТИРОВАНИЕ ИНЖЕНЕРНЫХ СИСТЕМ</a>
        </div>
        <div>
          <strong>СОТРУДНИЧЕСТВО</strong>
          <a href="#">ДИЗАЙНЕРАМ И АРХИТЕКТОРАМ</a>
          <a href="#">РУКОВОДИТЕЛЯМ СТРОИТЕЛЬНЫХ КОМПАНИЙ И ПРОЕКТОВ</a>
          <a href="#">ДИСТРИБЬЮТОРАМ</a>
        </div>
      </div>

      <div class="footer-divider"></div>

      <div class="footer-bottom-wrapper">
        <div class="footer-bottom">
          <div class="vertical-text-footer">
            <img src="{{ url_for('static', filename='images/vavip_logo_text.png') }}" alt="Vavip" />
          </div>
          <div class="social-icons">
            {% for name in ['telegram','instagram','vk','pinterest','youtube'] %}
            <a href="#" class="social-icon {{ name }}"><img src="{{ url_for('static', filename='images/icons/' + name + '.svg') }}" alt="{{ name }}"></a>
            {% endfor %}
          </div>
        </div>
        <div class="copyright-text">© 2024 Vavip. All Rights Reserved</div>
      </div>
    </div>
  </footer>
</div>

<script>
// Логика активного видео
const videoSections = document.querySelectorAll('.video-section');
function updateActiveVideo() {
  const windowMiddle = window.innerHeight / 2;
  videoSections.forEach(section => {
    const rect = section.getBoundingClientRect();
    const sectionMiddle = rect.top + rect.height / 2;
    if (Math.abs(sectionMiddle - windowMiddle) < rect.height / 2) {
      section.classList.add('active');
    } else {
      section.classList.remove('active');
    }
  });
}
window.addEventListener('scroll', updateActiveVideo);
window.addEventListener('resize', updateActiveVideo);
updateActiveVideo();

// Блюр видео при открытии dropdown с задержкой
const menuItems = document.querySelectorAll('.menu-item');
menuItems.forEach(item => {
  const dropdown = item.querySelector('.dropdown-content');
  let hoverTimeout;

  item.addEventListener('mouseenter', () => {
    hoverTimeout = setTimeout(() => {
      dropdown.classList.add('show');
      videoSections.forEach(sec => sec.querySelector('video').style.filter = 'blur(5px)');
    }, 300); // задержка перед выпадением
  });

  item.addEventListener('mouseleave', () => {
    clearTimeout(hoverTimeout);
    setTimeout(() => {
      if (!dropdown.matches(':hover')) {
        dropdown.classList.remove('show');
        videoSections.forEach(sec => sec.querySelector('video').style.filter = '');
      }
    }, 50);
  });

  dropdown.addEventListener('mouseenter', () => {
    clearTimeout(hoverTimeout);
    dropdown.classList.add('show');
    videoSections.forEach(sec => sec.querySelector('video').style.filter = 'blur(5px)');
  });

  dropdown.addEventListener('mouseleave', () => {
    dropdown.classList.remove('show');
    videoSections.forEach(sec => sec.querySelector('video').style.filter = '');
  });
});
</script>
{% endblock %}

{% block content %}
<main>
  <div style="height:100px;"></div>
</main>
{% endblock %}
/